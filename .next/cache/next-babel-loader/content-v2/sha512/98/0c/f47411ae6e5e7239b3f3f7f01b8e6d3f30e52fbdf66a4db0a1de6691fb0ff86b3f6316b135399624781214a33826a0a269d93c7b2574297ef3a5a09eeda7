{"ast":null,"code":"import _regeneratorRuntime from \"C:/Server/data/htdocs/oilan-mirror/goco/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Server/data/htdocs/oilan-mirror/goco/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Server\\\\data\\\\htdocs\\\\oilan-mirror\\\\goco\\\\src\\\\components\\\\Forms\\\\SubscriptionPaymentForm\\\\SubscriptionPaymentForm.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState } from \"react\";\nimport styles from '../../../../styles/components/form.module.css';\n\nvar axios = require('axios')[\"default\"];\n\nimport classnames from 'classnames';\nimport bcrypt from \"bcryptjs\";\nimport globals from \"../../../globals\";\nimport { useRouter } from \"next/router\";\nimport SubscriptionCardsWrapper from \"../../SubscriptionCardsWrapper\";\nimport { Image } from \"react-bootstrap\";\n\nfunction SubscriptionPaymentForm(props) {\n  _s();\n\n  var _this = this;\n\n  var router = useRouter();\n\n  function prettify(num) {\n    var n = num.toString();\n    return n.replace(/(\\d{1,3}(?=(?:\\d\\d\\d)+(?!\\d)))/g, \"$1\" + ' ');\n  }\n\n  var packages = [{\n    id: 1,\n    title: 'месяц',\n    opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\n    price: 17000\n  }, {\n    id: 3,\n    title: 'месяца',\n    opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\n    price: 18000\n  }, {\n    id: 6,\n    title: 'месяцев',\n    opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\n    price: 30000\n  }];\n\n  var _useState = useState(0),\n      selectedPack = _useState[0],\n      setSelectedPack = _useState[1];\n\n  var _useState2 = useState(1),\n      selectedMonthCount = _useState2[0],\n      setSelectedMonthCount = _useState2[1];\n\n  var _useState3 = useState(0),\n      totalPrice = _useState3[0],\n      setTotalPrice = _useState3[1];\n\n  var _useState4 = useState(true),\n      showPackages = _useState4[0],\n      setShowPackages = _useState4[1];\n\n  var _useState5 = useState(''),\n      message = _useState5[0],\n      setMessage = _useState5[1];\n\n  var _useState6 = useState(false),\n      ofertaCheck = _useState6[0],\n      setOfertaCheck = _useState6[1];\n\n  var createPayment = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(reference_id, price) {\n      var paymentHost, secret_key, salt, paymentPayload, paymentData, result, redirectUrl;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              paymentHost = \"https://finddifferences.club/proxy\";\n              secret_key = \"CbYf5sAuv4VJyFz9cD9x\";\n              salt = bcrypt.genSaltSync(10);\n              paymentPayload = {\n                centerId: +localStorage.getItem(globals.localStorageKeys.centerId)\n              };\n              paymentData = {\n                reference_id: reference_id,\n                request_url: \"\".concat(globals.productionServerDomain, \"/handlepayment\"),\n                back_url: \"\".concat(globals.productionServerDomain, \"/handlepayment\"),\n                amount: price,\n                description: JSON.stringify(paymentPayload),\n                merchant_id: 66,\n                secret_key: bcrypt.hashSync(reference_id + secret_key, salt)\n              };\n              _context.next = 7;\n              return axios.post(\"\".concat(paymentHost, \"/invoice/create\"), paymentData, {\n                headers: {\n                  'Access': 'application/json '\n                }\n              });\n\n            case 7:\n              result = _context.sent;\n\n              if (!result['data']['success']) {\n                _context.next = 14;\n                break;\n              }\n\n              redirectUrl = result['data']['data']['redirect_url'];\n              _context.next = 12;\n              return router.push(redirectUrl);\n\n            case 12:\n              _context.next = 15;\n              break;\n\n            case 14:\n              console.log(result);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function createPayment(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  function prettify(num) {\n    var n = num.toString();\n    return n.replace(/(\\d{1,3}(?=(?:\\d\\d\\d)+(?!\\d)))/g, \"$1\" + ' ');\n  }\n\n  return __jsx(\"div\", {\n    className: styles.formBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    style: {\n      width: '100%',\n      display: showPackages ? 'block' : 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, packages.map(function (pack) {\n    return __jsx(\"div\", {\n      className: classnames(styles[\"package\"]),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 25\n      }\n    }, __jsx(\"hr\", {\n      style: {\n        margin: '5px 0'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 29\n      }\n    }), __jsx(\"div\", {\n      className: styles.packageHeader,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 29\n      }\n    }, __jsx(\"span\", {\n      className: styles.packageTitle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 33\n      }\n    }, __jsx(\"span\", {\n      className: styles.packId,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 71\n      }\n    }, pack.id), \" \", pack.title), __jsx(\"span\", {\n      className: styles.price,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 33\n      }\n    }, __jsx(\"span\", {\n      className: styles.packId,\n      style: {\n        fontFamily: 'Rubik Bold',\n        marginRight: 10\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 37\n      }\n    }, prettify(pack.price)), \"KZT\")), pack.opportunities.map(function (title) {\n      return __jsx(\"div\", {\n        className: styles.listItem,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 33\n        }\n      }, __jsx(Image, {\n        src: '/violet_galochka.png',\n        className: styles.opportunitiesImage,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 37\n        }\n      }), __jsx(\"span\", {\n        className: styles.opportunities,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 37\n        }\n      }, title));\n    }), __jsx(\"button\", {\n      className: styles.btn,\n      onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return setTotalPrice(pack.price);\n\n              case 2:\n                _context2.next = 4;\n                return createPayment(Math.floor(Math.random() * 100000), pack.price);\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      })),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 29\n      }\n    }, \"\\u041F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C\"), __jsx(\"hr\", {\n      style: {\n        margin: '5px 0'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 29\n      }\n    }));\n  })), __jsx(\"div\", {\n    style: {\n      width: '100%',\n      display: showPackages ? 'none' : 'block'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  }, selectedPack !== 100 ? __jsx(\"div\", {\n    style: {\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 29\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 33\n    }\n  }, \"\\u0412\\u044B \\u0432\\u044B\\u0431\\u0440\\u0430\\u043B\\u0438 \\u043F\\u0430\\u043A\\u0435\\u0442 \\u043D\\u0430 \", __jsx(\"span\", {\n    style: {\n      fontWeight: 'bold'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 57\n    }\n  }, selectedMonthCount), \" \\u043C\\u0435\\u0441\\u044F\\u0446\\u0435\\u0432.\"), __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 33\n    }\n  }), \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 39\n    }\n  }), __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 33\n    }\n  }, \"\\u041A \\u043E\\u043F\\u043B\\u0430\\u0442\\u0435: \", __jsx(\"span\", {\n    style: {\n      fontWeight: 'bold'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 49\n    }\n  }, totalPrice, \" KZT\"), \" \"), __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 33\n    }\n  }), __jsx(\"button\", {\n    className: styles.formSubmit,\n    style: {\n      marginTop: '10px'\n    },\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var referenceId;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              referenceId = Math.floor(Math.random() * 999999) + 1;\n              _context3.next = 3;\n              return createPayment(referenceId);\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 33\n    }\n  }, \"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0438\\u0442\\u044C\")) : __jsx(\"div\", {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 29\n    }\n  }, __jsx(\"span\", {\n    style: {\n      fontWeight: 'bold',\n      color: \"white\",\n      borderBottom: '1px dashed red'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 33\n    }\n  }, \"\\u0412\\u044B \\u043D\\u0435 \\u0432\\u044B\\u0431\\u0440\\u0430\\u043B\\u0438 \\u043F\\u0430\\u043A\\u0435\\u0442 \\u0434\\u043B\\u044F \\u043F\\u043E\\u0434\\u043F\\u0438\\u0441\\u043A\\u0438!\")), __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 17\n    }\n  }, __jsx(\"span\", {\n    style: {\n      color: 'white',\n      fontSize: '12px',\n      textDecoration: 'underline',\n      cursor: \"pointer\"\n    },\n    onClick: function onClick() {\n      setShowPackages(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 21\n    }\n  }, \"\\u0412\\u0435\\u0440\\u043D\\u0443\\u0442\\u044C\\u0441\\u044F \\u043A \\u0432\\u044B\\u0431\\u043E\\u0440\\u0443 \\u043F\\u0430\\u043A\\u0435\\u0442\\u043E\\u0432\"))));\n}\n\n_s(SubscriptionPaymentForm, \"OSL04s0ZsvTcAIrickDcKkl/fk8=\", false, function () {\n  return [useRouter];\n});\n\n_c = SubscriptionPaymentForm;\nexport default SubscriptionPaymentForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"SubscriptionPaymentForm\");","map":{"version":3,"sources":["C:/Server/data/htdocs/oilan-mirror/goco/src/components/Forms/SubscriptionPaymentForm/SubscriptionPaymentForm.js"],"names":["React","useState","styles","axios","require","classnames","bcrypt","globals","useRouter","SubscriptionCardsWrapper","Image","SubscriptionPaymentForm","props","router","prettify","num","n","toString","replace","packages","id","title","opportunities","price","selectedPack","setSelectedPack","selectedMonthCount","setSelectedMonthCount","totalPrice","setTotalPrice","showPackages","setShowPackages","message","setMessage","ofertaCheck","setOfertaCheck","createPayment","reference_id","paymentHost","secret_key","salt","genSaltSync","paymentPayload","centerId","localStorage","getItem","localStorageKeys","paymentData","request_url","productionServerDomain","back_url","amount","description","JSON","stringify","merchant_id","hashSync","post","headers","result","redirectUrl","push","console","log","formBody","width","display","map","pack","margin","packageHeader","packageTitle","packId","fontFamily","marginRight","listItem","opportunitiesImage","btn","Math","floor","random","fontWeight","formSubmit","marginTop","referenceId","textAlign","color","borderBottom","justifyContent","fontSize","textDecoration","cursor"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport styles from '../../../../styles/components/form.module.css'\r\nconst axios = require('axios').default;\r\nimport classnames from 'classnames'\r\nimport bcrypt from \"bcryptjs\";\r\nimport globals from \"../../../globals\";\r\nimport {useRouter} from \"next/router\";\r\nimport SubscriptionCardsWrapper from \"../../SubscriptionCardsWrapper\";\r\nimport {Image} from \"react-bootstrap\";\r\n\r\nfunction SubscriptionPaymentForm(props) {\r\n\r\nconst router = useRouter();\r\n\r\n\r\n    function prettify(num) {\r\n        var n = num.toString();\r\n        return n.replace(/(\\d{1,3}(?=(?:\\d\\d\\d)+(?!\\d)))/g, \"$1\" + ' ');\r\n    }\r\n\r\n    const packages = [\r\n        {\r\n            id: 1,\r\n            title: 'месяц',\r\n            opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\r\n            price: 17000\r\n        },\r\n        {\r\n            id: 3,\r\n            title: 'месяца',\r\n            opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\r\n            price: 18000\r\n        },\r\n        {\r\n            id: 6,\r\n            title: 'месяцев',\r\n            opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\r\n            price: 30000\r\n        },\r\n    ]\r\n\r\n    const [selectedPack, setSelectedPack] = useState(0);\r\n    const [selectedMonthCount, setSelectedMonthCount] = useState(1);\r\n    const [totalPrice, setTotalPrice] = useState(0);\r\n    const [showPackages, setShowPackages] = useState(true);\r\n\r\n    const [message, setMessage] = useState('');\r\n    const [ofertaCheck, setOfertaCheck] = useState(false);\r\n\r\n    const createPayment = async (reference_id, price) => {\r\n        let paymentHost = \"https://finddifferences.club/proxy\";\r\n        let secret_key = \"CbYf5sAuv4VJyFz9cD9x\";\r\n\r\n        const salt = bcrypt.genSaltSync(10);\r\n\r\n        const paymentPayload = {\r\n            centerId: +localStorage.getItem(globals.localStorageKeys.centerId),\r\n        }\r\n\r\n        let paymentData = {\r\n            reference_id: reference_id,\r\n            request_url: `${globals.productionServerDomain}/handlepayment`,\r\n            back_url: `${globals.productionServerDomain}/handlepayment`,\r\n            amount: price,\r\n            description: JSON.stringify(paymentPayload),\r\n            merchant_id: 66,\r\n            secret_key: bcrypt.hashSync(reference_id + secret_key, salt)\r\n        };\r\n\r\n        const result = await axios.post(\r\n            `${paymentHost}/invoice/create`,\r\n            paymentData,\r\n            {headers: {'Access': 'application/json '}}\r\n        );\r\n\r\n        if(result['data']['success']){\r\n            let redirectUrl = result['data']['data']['redirect_url'];\r\n            await router.push(redirectUrl)\r\n        }else{\r\n            console.log(result);\r\n        }\r\n    }\r\n    function prettify(num) {\r\n        var n = num.toString();\r\n        return n.replace(/(\\d{1,3}(?=(?:\\d\\d\\d)+(?!\\d)))/g, \"$1\" + ' ');\r\n    }\r\n\r\n    return (\r\n        <div className={styles.formBody} >\r\n            <div style={{width: '100%', display: showPackages ? 'block' : 'none'}}>\r\n                {packages.map((pack)=>{\r\n                    return(\r\n                        <div className={classnames(styles.package)}>\r\n                            <hr style={{margin: '5px 0'}}/>\r\n                            <div className={styles.packageHeader}>\r\n                                <span className={styles.packageTitle}><span className={styles.packId}>{pack.id}</span> {pack.title}</span>\r\n                                <span className={styles.price}>\r\n                                    <span className={styles.packId} style={{fontFamily: 'Rubik Bold', marginRight: 10}}>\r\n                                        {prettify(pack.price)}\r\n                                    </span>KZT\r\n                                </span>\r\n                            </div>\r\n                            {pack.opportunities.map(title => (\r\n                                <div className={styles.listItem}>\r\n                                    <Image src={'/violet_galochka.png'} className={styles.opportunitiesImage}/>\r\n                                    <span className={styles.opportunities}>{title}</span>\r\n                                </div>\r\n                            ))}\r\n                            <button\r\n                                className={styles.btn}\r\n                                onClick={async () => {\r\n                                    await setTotalPrice(pack.price);\r\n                                    await createPayment(Math.floor(Math.random()*100000), pack.price)\r\n                                }}\r\n                            >Подключить</button>\r\n                            <hr style={{margin: '5px 0'}}/>\r\n                        </div>\r\n                    )\r\n                })}\r\n                {/*<span style={{fontFamily: 'sans-serif', fontWeight: 'bold', color: 'black', marginTop: '10px'}}>{message}</span> <br/>*/}\r\n                {/*<label style={{fontFamily: 'sans-serif', fontWeight: 'bold', color: 'white', marginTop: '10px'}}>*/}\r\n                {/*    <input*/}\r\n                {/*        type=\"checkbox\"*/}\r\n                {/*        onClick={() => {*/}\r\n                {/*            setOfertaCheck(!ofertaCheck)*/}\r\n                {/*        }}*/}\r\n                {/*    /> <font style={{color: 'black'}}> Я принимаю условия </font> <a href=\"/offer\" style={{color: 'blue', textDecoration: 'underline'}}>публичной оферты.</a>*/}\r\n                {/*</label> <br/>*/}\r\n                {/*<span style={{color: 'black'}}>Выберите количество месяцев подписки</span>*/}\r\n\r\n                {/*<div style={{width: '100%', display: 'flex', justifyContent: 'space-between', marginTop: '10px', alignItems: 'center'}}>*/}\r\n                {/*    <select onChange={ event => setSelectedMonthCount(event.target.value)} className={styles.paymentFormSelect} >*/}\r\n                {/*        <option value={1}>1 месяц</option>*/}\r\n                {/*        <option value={3}>3 месяца</option>*/}\r\n                {/*        <option value={6}>6 месяцев</option>*/}\r\n                {/*    </select>*/}\r\n\r\n\r\n                {/*    <button className={styles.formSubmit} onClick={() => {*/}\r\n                {/*        if(ofertaCheck){*/}\r\n                {/*            setMessage('')*/}\r\n                {/*            setShowPackages(false);*/}\r\n                {/*            setTotalPrice(packages[0].periods.filter(item => item.monthCount === Number(selectedMonthCount))[0].price);*/}\r\n                {/*        } else {*/}\r\n                {/*            setMessage('Прочтите публичную оферту и дайте свое согласие!')*/}\r\n                {/*        }*/}\r\n                {/*    }}>Перейти к оплате</button>*/}\r\n                {/*</div>*/}\r\n            </div>\r\n\r\n            <div style={{width: '100%', display: showPackages ? 'none' : 'block'}}>\r\n                {\r\n                    selectedPack !== 100 ?\r\n                        (\r\n                            <div style={{width: '100%'}}>\r\n                                <span>\r\n                                    Вы выбрали пакет на <span style={{fontWeight: 'bold'}}>{selectedMonthCount}</span> месяцев.\r\n                                </span>\r\n\r\n                                <br/> <br/>\r\n\r\n                                <span>К оплате: <span style={{fontWeight: 'bold'}}>{totalPrice} KZT</span> </span>\r\n                                <br/>\r\n\r\n                                <button className={styles.formSubmit} style={{marginTop: '10px'}} onClick={ async() => {\r\n                                    let referenceId = Math.floor(Math.random() * 999999) + 1;\r\n                                    await createPayment(referenceId);\r\n                                }}>Оплатить</button>\r\n                            </div>\r\n                        )\r\n                        :\r\n                        (\r\n                            <div style={{width: '100%', textAlign: 'center', }}>\r\n                                <span style={{fontWeight: 'bold', color: \"white\", borderBottom: '1px dashed red'}}>Вы не выбрали пакет для подписки!</span>\r\n                            </div>\r\n                        )\r\n                }\r\n                <div style={{display:'flex', width: '100%', justifyContent: 'center'}}>\r\n                    <span style={{color: 'white', fontSize: '12px', textDecoration: 'underline', cursor: \"pointer\"}}\r\n                          onClick={ () => {\r\n                              setShowPackages(true)\r\n                          }}>Вернуться к выбору пакетов</span>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SubscriptionPaymentForm;\r\n"]},"metadata":{},"sourceType":"module"}