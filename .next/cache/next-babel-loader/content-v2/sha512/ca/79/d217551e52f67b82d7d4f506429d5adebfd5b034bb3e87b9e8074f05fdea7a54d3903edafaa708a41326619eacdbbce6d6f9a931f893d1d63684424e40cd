{"ast":null,"code":"import _regeneratorRuntime from \"C:/Server/data/htdocs/oilanio-mirror-agarey/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Server/data/htdocs/oilanio-mirror-agarey/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Server\\\\data\\\\htdocs\\\\oilanio-mirror-agarey\\\\src\\\\components\\\\SubscriptionCardsWrapper\\\\index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport styles from './style.module.css';\nimport { useState } from \"react\";\nimport { Image } from \"react-bootstrap\";\nimport bcrypt from \"bcryptjs\";\nimport globals from \"../../globals\";\nimport { default as axios } from \"axios\";\nimport { useRouter } from \"next/router\";\n\nvar SubscriptionCardsWrapper = function SubscriptionCardsWrapper() {\n  _s();\n\n  function prettify(num) {\n    var n = num.toString();\n    return n.replace(/(\\d{1,3}(?=(?:\\d\\d\\d)+(?!\\d)))/g, \"$1\" + ' ');\n  }\n\n  var router = useRouter();\n\n  var _useState = useState([{\n    id: 1,\n    title: 'Месяц',\n    opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\n    price: localStorage.getItem(globals.localStorageKeys.centerId) == 316 ? 10000 : 15000\n  }, {\n    id: 3,\n    title: 'Месяца',\n    opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\n    price: 42000\n  }, {\n    id: 6,\n    title: 'Месяцев',\n    opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\n    price: 78000\n  }]),\n      subsriptionsCards = _useState[0],\n      setSubscriptionsCards = _useState[1];\n\n  var createPayment = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(monthCount, totalPrice) {\n      var reference_id, paymentHost, secret_key, salt, paymentPayload, paymentData, result, redirectUrl;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              reference_id = Math.floor(Math.random() * 999999) + 1;\n              paymentHost = \"https://finddifferences.club/proxy\";\n              secret_key = \"CbYf5sAuv4VJyFz9cD9x\";\n              salt = bcrypt.genSaltSync(10);\n              paymentPayload = {\n                centerId: localStorage.getItem(globals.localStorageKeys.centerId),\n                monthCount: monthCount\n              };\n              paymentData = {\n                reference_id: reference_id,\n                request_url: \"\".concat(globals.productionServerDomain, \"/handlepayment\"),\n                back_url: \"\".concat(globals.productionServerDomain, \"/handlepayment\"),\n                amount: totalPrice,\n                description: JSON.stringify(paymentPayload),\n                merchant_id: 66,\n                secret_key: bcrypt.hashSync(reference_id + secret_key, salt)\n              };\n              _context.next = 8;\n              return axios.post(\"\".concat(paymentHost, \"/invoice/create\"), paymentData, {\n                headers: {\n                  'Access': 'application/json '\n                }\n              });\n\n            case 8:\n              result = _context.sent;\n\n              if (!result['data']['success']) {\n                _context.next = 15;\n                break;\n              }\n\n              redirectUrl = result['data']['data']['redirect_url'];\n              _context.next = 13;\n              return router.push(redirectUrl);\n\n            case 13:\n              _context.next = 16;\n              break;\n\n            case 15:\n              console.log(result);\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function createPayment(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, subsriptionsCards.map(function (card) {\n    return __jsx(\"div\", {\n      className: styles.card,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 21\n      }\n    }, __jsx(\"div\", {\n      style: {\n        width: \"100%\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 25\n      }\n    }, __jsx(\"div\", {\n      className: styles.cardTop,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 29\n      }\n    }, __jsx(\"span\", {\n      className: styles.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 33\n      }\n    }, card.id), __jsx(\"span\", {\n      className: styles.cardTitle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 33\n      }\n    }, card.title)), __jsx(\"div\", {\n      className: styles.list,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 29\n      }\n    }, card.opportunities.map(function (title) {\n      return __jsx(\"div\", {\n        className: styles.listItem,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 37\n        }\n      }, __jsx(Image, {\n        src: 'violet_galochka.png',\n        className: styles.opportunitiesImage,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 41\n        }\n      }), __jsx(\"span\", {\n        className: styles.opportunities,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 41\n        }\n      }, title));\n    }))), __jsx(\"div\", {\n      className: styles.price,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 25\n      }\n    }, prettify(card.price), \" KZT\"), __jsx(\"div\", {\n      className: styles.center,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 25\n      }\n    }, __jsx(\"button\", {\n      className: styles.btn,\n      onClick: function onClick() {\n        return createPayment(card.id, card.price);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 29\n      }\n    }, \"\\u041F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C\")));\n  }));\n};\n\n_s(SubscriptionCardsWrapper, \"3H9eS/yBPVQJ43LQJ1fXVMkaFkU=\", false, function () {\n  return [useRouter];\n});\n\n_c = SubscriptionCardsWrapper;\nexport default SubscriptionCardsWrapper;\n\nvar _c;\n\n$RefreshReg$(_c, \"SubscriptionCardsWrapper\");","map":{"version":3,"sources":["C:/Server/data/htdocs/oilanio-mirror-agarey/src/components/SubscriptionCardsWrapper/index.js"],"names":["styles","useState","Image","bcrypt","globals","default","axios","useRouter","SubscriptionCardsWrapper","prettify","num","n","toString","replace","router","id","title","opportunities","price","localStorage","getItem","localStorageKeys","centerId","subsriptionsCards","setSubscriptionsCards","createPayment","monthCount","totalPrice","reference_id","Math","floor","random","paymentHost","secret_key","salt","genSaltSync","paymentPayload","paymentData","request_url","productionServerDomain","back_url","amount","description","JSON","stringify","merchant_id","hashSync","post","headers","result","redirectUrl","push","console","log","container","map","card","width","cardTop","cardTitle","list","listItem","opportunitiesImage","center","btn"],"mappings":"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","sourcesContent":["import styles from './style.module.css'\r\nimport {useState} from \"react\";\r\nimport {Image} from \"react-bootstrap\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport globals from \"../../globals\";\r\nimport {default as axios} from \"axios\";\r\nimport {useRouter} from \"next/router\";\r\n\r\nconst SubscriptionCardsWrapper = () => {\r\n    function prettify(num) {\r\n        let n = num.toString();\r\n        return n.replace(/(\\d{1,3}(?=(?:\\d\\d\\d)+(?!\\d)))/g, \"$1\" + ' ');\r\n    }\r\n\r\n    const router = useRouter();\r\n\r\n    const [subsriptionsCards, setSubscriptionsCards] = useState([\r\n        {\r\n            id: 1,\r\n            title: 'Месяц',\r\n            opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\r\n            price: (localStorage.getItem(globals.localStorageKeys.centerId) == 316)?10000:15000\r\n        },\r\n        {\r\n            id: 3,\r\n            title: 'Месяца',\r\n            opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\r\n            price: 42000\r\n        },\r\n        {\r\n            id: 6,\r\n            title: 'Месяцев',\r\n            opportunities: [\"Неограниченное размещение курсов\", \"Публикация акции\", \"Активация личного кабинета\", \"Рассылка заявок\", \"Обработка заявок\"],\r\n            price: 78000\r\n        },\r\n    ]);\r\n\r\n    const createPayment = async (monthCount, totalPrice) => {\r\n        let reference_id = Math.floor(Math.random() * 999999) + 1;\r\n\r\n        let paymentHost = \"https://finddifferences.club/proxy\";\r\n        let secret_key = \"CbYf5sAuv4VJyFz9cD9x\";\r\n\r\n        const salt = bcrypt.genSaltSync(10);\r\n\r\n        const paymentPayload = {\r\n            centerId: localStorage.getItem(globals.localStorageKeys.centerId),\r\n            monthCount: monthCount,\r\n        }\r\n\r\n        let paymentData = {\r\n            reference_id: reference_id,\r\n            request_url: `${globals.productionServerDomain}/handlepayment`,\r\n            back_url: `${globals.productionServerDomain}/handlepayment`,\r\n            amount: totalPrice,\r\n            description: JSON.stringify(paymentPayload),\r\n            merchant_id: 66,\r\n            secret_key: bcrypt.hashSync(reference_id + secret_key, salt)\r\n        };\r\n\r\n        const result = await axios.post(\r\n            `${paymentHost}/invoice/create`,\r\n            paymentData,\r\n            {headers: {'Access': 'application/json '}}\r\n        );\r\n\r\n        if(result['data']['success']){\r\n            let redirectUrl = result['data']['data']['redirect_url'];\r\n            await router.push(redirectUrl)\r\n        }else{\r\n            console.log(result);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            {\r\n                subsriptionsCards.map(card => (\r\n                    <div className={styles.card}>\r\n                        <div style={{width: \"100%\"}}>\r\n                            <div className={styles.cardTop}>\r\n                                <span className={styles.id}>{card.id}</span>\r\n                                <span className={styles.cardTitle}>{card.title}</span>\r\n                            </div>\r\n                            <div className={styles.list}>\r\n                                {card.opportunities.map(title => (\r\n                                    <div className={styles.listItem}>\r\n                                        <Image src={'violet_galochka.png'} className={styles.opportunitiesImage}/>\r\n                                        <span className={styles.opportunities}>{title}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className={styles.price}>\r\n                            {prettify(card.price)} KZT\r\n                        </div>\r\n\r\n                        <div className={styles.center}>\r\n                            <button\r\n                                className={styles.btn}\r\n                                onClick={() => createPayment(card.id, card.price)}\r\n                            >Подключить</button>\r\n                        </div>\r\n                    </div>\r\n                ))\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SubscriptionCardsWrapper;"]},"metadata":{},"sourceType":"module"}