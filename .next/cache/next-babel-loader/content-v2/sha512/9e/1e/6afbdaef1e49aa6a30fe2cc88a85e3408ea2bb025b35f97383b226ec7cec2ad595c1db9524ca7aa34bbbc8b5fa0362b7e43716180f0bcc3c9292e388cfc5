{"ast":null,"code":"var _jsxFileName = \"C:\\\\Server\\\\data\\\\htdocs\\\\oilanio-mirror\\\\pages\\\\login\\\\index.js\";\nvar __jsx = React.createElement;\nimport Head from 'next/head';\nimport Header from '../../src/components/Header/Header';\nimport styles from \"../../styles/components/content/SignIn.module.css\";\nimport CourseCard from \"../../src/components/CourseCard/CourseCard\";\nimport HorizontalLine from \"../../src/components/HorizontalLine/HorizaontalLine\";\nimport Footer from \"../../src/components/Footer/Footer\";\nimport React, { useState, useEffect } from \"react\";\nimport Slider from 'react-animated-slider';\nimport 'react-animated-slider/build/horizontal.css';\nimport SimpleSlider from \"../../src/components/SimpleSlider/SimpleSlider\";\nimport StockCard from \"../../src/components/StockCard/StockCard\";\nimport ContactButton from \"../../src/components/ContactButton/ContactButton\";\nimport classnames from 'classnames';\nimport Courses from \"../courses\";\nimport { useRouter } from \"next/router\";\n\nconst axios = require('axios').default;\n\nconst bcrypt = require('bcryptjs');\n\nimport globals from \"../../src/globals\";\nimport UserContext from \"../../src/userContext\";\nimport { useContext } from \"react\";\nimport { useCookies } from 'react-cookie';\nimport { SignupToCourseForm } from \"../../src/components/Forms/SignupToCourseForm/SignupToCourseForm\";\nimport ModalWindow from \"../../src/components/Modal/ModalWindow\";\nimport { BecomeAPartner } from \"../../src/components/Forms/BecomeAPartnerForm/BecomeAPartner\";\n\nfunction SignIn(props) {\n  let contextData = useContext(UserContext);\n  const router = useRouter();\n  const {\n    0: studentPhone,\n    1: setStudentPhone\n  } = useState('8(7');\n  const {\n    0: loginValue,\n    1: setLoginValue\n  } = useState(\"\");\n  const {\n    0: passwordValue,\n    1: setPasswordValue\n  } = useState(\"\");\n  const {\n    0: showPassword,\n    1: setShowPassword\n  } = useState(false);\n  const {\n    0: showModal,\n    1: setShowModal\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n  const {\n    0: messageText,\n    1: setMessageText\n  } = useState('Введите данные для входа');\n  const {\n    0: interfaceForStudent,\n    1: setInterfaceForStudent\n  } = useState(false);\n  const {\n    0: oldLoginDataIsRemoved,\n    1: setOldDataIsRemoved\n  } = useState(false);\n  const {\n    0: ofertaCheck,\n    1: setOfertaCheck\n  } = useState(false);\n  const {\n    0: show,\n    1: setShow\n  } = useState(false);\n\n  const handleClose = () => setShow(false);\n\n  const removeOldLoginData = () => {\n    localStorage.removeItem(globals.localStorageKeys.currentStudent);\n    localStorage.removeItem(globals.localStorageKeys.authToken);\n    localStorage.removeItem(globals.localStorageKeys.centerId);\n    localStorage.removeItem(globals.localStorageKeys.currentUserId);\n    localStorage.removeItem(globals.localStorageKeys.roleId);\n    setOldDataIsRemoved(true);\n  };\n\n  async function register(centerName, login, password, website, addresses, phone, cityId) {\n    const salt = bcrypt.genSaltSync(10);\n    password = bcrypt.hashSync(password, salt);\n    let data = {\n      title: centerName,\n      login: login,\n      password: password,\n      website_url: website,\n      addresses: addresses,\n      phones: phone,\n      city_id: cityId\n    };\n    const result = await axios.post(globals.productionServerDomain + '/courses/register', data);\n\n    if (result.status !== 200) {\n      await router.push(\"https://www.oilan.io/\");\n    } else {\n      console.log(\"errorritto\");\n    }\n  }\n\n  const ym = () => {\n    return \"<!-- Yandex.Metrika counter -->\\n\" + \"<script type=\\\"text/javascript\\\" >\\n\" + \"   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};\\n\" + \"   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})\\n\" + \"   (window, document, \\\"script\\\", \\\"https://mc.yandex.ru/metrika/tag.js\\\", \\\"ym\\\");\\n\" + \"\\n\" + \"   ym(78186067, \\\"init\\\", {\\n\" + \"        clickmap:true,\\n\" + \"        trackLinks:true,\\n\" + \"        accurateTrackBounce:true,\\n\" + \"        webvisor:true,\\n\" + \"        ecommerce:\\\"dataLayer\\\"\\n\" + \"   });\\n\" + \"</script>\\n\" + \"<noscript><div><img src=\\\"https://mc.yandex.ru/watch/78186067\\\" style=\\\"position:absolute; left:-9999px;\\\" alt=\\\"\\\" /></div></noscript>\\n\" + \"<!-- /Yandex.Metrika counter -->\";\n  };\n\n  useEffect(() => {\n    setOldDataIsRemoved(false);\n    removeOldLoginData();\n  }, []);\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, \"Oilan - \\u0412\\u0445\\u043E\\u0434\"), __jsx(\"link\", {\n    rel: \"icon\",\n    href: \"/atom-icon.png\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: ym()\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  })), oldLoginDataIsRemoved && __jsx(Header, {\n    white: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 39\n    }\n  }), __jsx(ModalWindow, {\n    show: show,\n    handleClose: handleClose,\n    heading: ``,\n    body: __jsx(BecomeAPartner, {\n      handleClose: handleClose,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 83\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: styles.modal,\n    style: {\n      display: showModal ? 'block' : 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'space-between'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 17\n    }\n  }, __jsx(\"span\", {\n    style: {\n      fontSize: '14px',\n      fontWeight: 'bold'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 21\n    }\n  }, \"\\u0421\\u043B\\u0443\\u0436\\u0431\\u0430 \\u0437\\u0430\\u0431\\u043E\\u0442\\u044B \\u043E \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\\u0445\"), __jsx(\"span\", {\n    style: {\n      fontSize: '14px',\n      fontWeight: 'bold',\n      cursor: 'pointer'\n    },\n    onClick: () => {\n      setShowModal(!showModal);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 21\n    }\n  }, \"x\")), __jsx(\"span\", {\n    style: {\n      fontSize: '12px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  }, \"8:00-20:00 \\u0440\\u0430\\u0431\\u043E\\u0447\\u0438\\u0435 \\u0434\\u043D\\u0438\"), \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 80\n    }\n  }), __jsx(\"span\", {\n    style: {\n      fontSize: '12px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }\n  }, \"9:00-17:00 \\u043F\\u0440\\u0430\\u0437\\u0434\\u043D\\u0438\\u0447\\u043D\\u044B\\u0435 \\u0438 \\u0432\\u044B\\u0445\\u043E\\u0434\\u043D\\u044B\\u0435 \\u0434\\u043D\\u0438\"), \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 95\n    }\n  }), \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 101\n    }\n  }), __jsx(\"span\", {\n    style: {\n      fontSize: '14px',\n      fontWeight: 'bold'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }\n  }, \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u044B:\"), \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 87\n    }\n  }), __jsx(\"span\", {\n    style: {\n      fontSize: '12px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 17\n    }\n  }, \"+7 (747) 095 3440 (WhatsApp, \\u0417\\u0432\\u043E\\u043D\\u043E\\u043A)\"), \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 94\n    }\n  })), __jsx(\"div\", {\n    className: styles.signInBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: classnames(styles.formBody),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: styles.header,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 25\n    }\n  }, __jsx(\"div\", {\n    className: classnames(styles.headerItem, styles.headerItemLeft, !interfaceForStudent && styles.selected),\n    onClick: () => {\n      setInterfaceForStudent(false);\n      setLoginValue('');\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 29\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 33\n    }\n  }, \"\\u042F \\u0446\\u0435\\u043D\\u0442\\u0440/\\u0440\\u0435\\u043F\\u0435\\u0442\\u0438\\u0442\\u043E\\u0440\")), __jsx(\"div\", {\n    className: classnames(styles.headerItem, styles.headerItemRight, interfaceForStudent && styles.selected),\n    onClick: () => {\n      setInterfaceForStudent(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 29\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 33\n    }\n  }, \"\\u042F \\u0441\\u0442\\u0443\\u0434\\u0435\\u043D\\u0442\"))), __jsx(\"div\", {\n    className: styles.form,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 25\n    }\n  }, __jsx(\"span\", {\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 29\n    }\n  }, \"\\u0420\\u0430\\u0434\\u044B, \\u0447\\u0442\\u043E \\u0432\\u044B \\u0432\\u0435\\u0440\\u043D\\u0443\\u043B\\u0438\\u0441\\u044C\"), __jsx(\"p\", {\n    className: error ? styles.errorMessage : styles.message,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 29\n    }\n  }, messageText), interfaceForStudent ? __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: styles.inputBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 37\n    }\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.input,\n    onKeyDown: e => {\n      if (e.keyCode === 8) {\n        setStudentPhone(studentPhone.slice(0, -1));\n      }\n    },\n    onChange: e => globals.checkPhoneMask(e.target.value, setStudentPhone),\n    placeholder: \"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\",\n    value: studentPhone,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 41\n    }\n  })), __jsx(\"label\", {\n    style: {\n      fontFamily: 'Rubik Medium',\n      color: 'black',\n      marginTop: '10px',\n      cursor: 'pointer',\n      width: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 37\n    }\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    onClick: () => {\n      setOfertaCheck(!ofertaCheck);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 41\n    }\n  }), \" \", __jsx(\"span\", {\n    style: {\n      marginLeft: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 44\n    }\n  }, \"\\u042F \\u043F\\u0440\\u0438\\u043D\\u0438\\u043C\\u0430\\u044E \\u0443\\u0441\\u043B\\u043E\\u0432\\u0438\\u044F \", __jsx(\"a\", {\n    href: \"/offer/student\",\n    style: {\n      color: 'black',\n      textDecoration: 'underline'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 94\n    }\n  }, \"\\u043F\\u0443\\u0431\\u043B\\u0438\\u0447\\u043D\\u043E\\u0439 \\u043E\\u0444\\u0435\\u0440\\u0442\\u044B.\")))) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: styles.inputBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 37\n    }\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.input,\n    value: loginValue,\n    onChange: e => setLoginValue(e.target.value),\n    placeholder: \"\\u041B\\u043E\\u0433\\u0438\\u043D\",\n    id: \"loginLogin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 41\n    }\n  })), __jsx(\"div\", {\n    className: styles.inputBody,\n    style: {\n      position: 'relative'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 37\n    }\n  }, __jsx(\"input\", {\n    type: showPassword ? 'text' : \"password\",\n    onChange: e => setPasswordValue(e.target.value),\n    className: styles.input,\n    placeholder: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n    id: \"loginPassword\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 41\n    }\n  }), passwordValue.length != 0 && __jsx(\"img\", {\n    src: !showPassword ? \"/view_eye.png\" : '/hidden.png',\n    alt: \"\",\n    className: styles.eye,\n    onClick: () => {\n      setShowPassword(!showPassword);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 69\n    }\n  }))), __jsx(\"div\", {\n    className: styles.inputBody,\n    style: {\n      marginTop: '15px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 29\n    }\n  }, __jsx(\"button\", {\n    className: styles.submitBtn,\n    onClick: () => {\n      setError(false);\n      setMessageText('Загрузка...');\n\n      if (interfaceForStudent) {\n        if (studentPhone.length !== 16) {\n          setMessageText('Неккоректная длина номера!');\n        } else if (!ofertaCheck) {\n          setMessageText('Потдвердите соглашение с публичной офертой!');\n        } else {\n          axios.post(`${globals.productionServerDomain}/studentLogin/`, {\n            phone: studentPhone\n          }).then(function (res) {\n            localStorage.setItem(globals.localStorageKeys.currentStudent, JSON.stringify(res.data));\n            router.push(`/cabinet/student`);\n            return;\n          }).catch(function () {\n            setMessageText('Номер телефона не найден!');\n          });\n        }\n      } else {\n        let data = {\n          login: loginValue,\n          password: passwordValue\n        };\n        axios.post(`${globals.productionServerDomain}/login/`, data).then(function (res) {\n          if (res.status === 200) {\n            let date = new Date();\n            let loginObject = {\n              expireTime: date + 60 * 1000 * 60,\n              token: res.data.token\n            };\n            localStorage.setItem(globals.localStorageKeys.authToken, JSON.stringify(loginObject));\n            localStorage.setItem(globals.localStorageKeys.centerId, res.data.centerId);\n            localStorage.setItem(globals.localStorageKeys.currentUserId, res.data.userId);\n            localStorage.setItem(globals.localStorageKeys.roleId, res.data.roleId);\n            console.log('center id set', res.data.centerId);\n\n            if (res.data.roleId === 1) {\n              router.push(`${globals.productionSiteDomain}/admin`);\n            } else if (res.data.roleId === 4) {\n              router.push(`${globals.productionSiteDomain}/cabinet`);\n            } else if (res.data.roleId === 6) {\n              router.push(`${globals.productionSiteDomain}/cabinet/tutor`);\n            }\n          } else {\n            setError(true);\n            setMessageText(\"Неправильные данные\");\n          }\n        }).catch(res => {\n          setError(true);\n          setMessageText(\"Неправильные данные! Попробуйте еще раз.\");\n        });\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 33\n    }\n  }, \"\\u0412\\u043E\\u0439\\u0442\\u0438 \\u0432 \\u043B\\u0438\\u0447\\u043D\\u044B\\u0439 \\u043A\\u0430\\u0431\\u0438\\u043D\\u0435\\u0442\")), __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 29\n    }\n  }), !interfaceForStudent && __jsx(\"div\", {\n    className: styles.inputBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 33\n    }\n  }, __jsx(\"span\", {\n    style: {\n      color: 'black',\n      cursor: 'pointer',\n      fontSize: '14px',\n      textDecoration: 'underline',\n      fontFamily: 'Rubik Regular'\n    },\n    onClick: () => {\n      setShow(!show);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 37\n    }\n  }, \"\\u0421\\u0442\\u0430\\u0442\\u044C \\u043F\\u0430\\u0440\\u0442\\u043D\\u0435\\u0440\\u043E\\u043C\"))))), __jsx(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 13\n    }\n  }));\n}\n\nexport default SignIn;","map":{"version":3,"sources":["C:/Server/data/htdocs/oilanio-mirror/pages/login/index.js"],"names":["Head","Header","styles","CourseCard","HorizontalLine","Footer","React","useState","useEffect","Slider","SimpleSlider","StockCard","ContactButton","classnames","Courses","useRouter","axios","require","default","bcrypt","globals","UserContext","useContext","useCookies","SignupToCourseForm","ModalWindow","BecomeAPartner","SignIn","props","contextData","router","studentPhone","setStudentPhone","loginValue","setLoginValue","passwordValue","setPasswordValue","showPassword","setShowPassword","showModal","setShowModal","error","setError","messageText","setMessageText","interfaceForStudent","setInterfaceForStudent","oldLoginDataIsRemoved","setOldDataIsRemoved","ofertaCheck","setOfertaCheck","show","setShow","handleClose","removeOldLoginData","localStorage","removeItem","localStorageKeys","currentStudent","authToken","centerId","currentUserId","roleId","register","centerName","login","password","website","addresses","phone","cityId","salt","genSaltSync","hashSync","data","title","website_url","phones","city_id","result","post","productionServerDomain","status","push","console","log","ym","__html","modal","display","alignItems","justifyContent","fontSize","fontWeight","cursor","signInBody","formBody","header","headerItem","headerItemLeft","selected","headerItemRight","form","errorMessage","message","inputBody","input","e","keyCode","slice","checkPhoneMask","target","value","fontFamily","color","marginTop","width","marginLeft","textDecoration","position","length","eye","submitBtn","then","res","setItem","JSON","stringify","catch","date","Date","loginObject","expireTime","token","userId","productionSiteDomain"],"mappings":"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","sourcesContent":["import Head from 'next/head'\r\nimport Header from '../../src/components/Header/Header'\r\nimport styles from \"../../styles/components/content/SignIn.module.css\";\r\nimport CourseCard from \"../../src/components/CourseCard/CourseCard\";\r\nimport HorizontalLine from \"../../src/components/HorizontalLine/HorizaontalLine\";\r\nimport Footer from \"../../src/components/Footer/Footer\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Slider from 'react-animated-slider';\r\nimport 'react-animated-slider/build/horizontal.css'\r\nimport SimpleSlider from \"../../src/components/SimpleSlider/SimpleSlider\";\r\nimport StockCard from \"../../src/components/StockCard/StockCard\";\r\nimport ContactButton from \"../../src/components/ContactButton/ContactButton\";\r\nimport classnames from 'classnames';\r\nimport Courses from \"../courses\";\r\nimport {useRouter} from \"next/router\";\r\nconst axios = require('axios').default;\r\nconst bcrypt = require('bcryptjs');\r\nimport globals from \"../../src/globals\";\r\nimport UserContext from \"../../src/userContext\";\r\nimport { useContext } from \"react\";\r\nimport { useCookies } from 'react-cookie';\r\nimport {SignupToCourseForm} from \"../../src/components/Forms/SignupToCourseForm/SignupToCourseForm\";\r\nimport ModalWindow from \"../../src/components/Modal/ModalWindow\";\r\nimport {BecomeAPartner} from \"../../src/components/Forms/BecomeAPartnerForm/BecomeAPartner\";\r\n\r\n\r\nfunction SignIn(props){\r\n    let contextData = useContext(UserContext);\r\n    const router = useRouter();\r\n    const [studentPhone, setStudentPhone] = useState('8(7');\r\n    const [loginValue, setLoginValue] = useState(\"\");\r\n    const [passwordValue, setPasswordValue] = useState(\"\");\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [error, setError] = useState(false);\r\n    const [messageText, setMessageText] = useState('Введите данные для входа');\r\n\r\n    const [interfaceForStudent, setInterfaceForStudent] = useState(false);\r\n    const [oldLoginDataIsRemoved, setOldDataIsRemoved] = useState(false);\r\n    const [ofertaCheck, setOfertaCheck] = useState(false);\r\n\r\n    const [show, setShow] = useState(false);\r\n    const handleClose = () => setShow(false);\r\n\r\n    const removeOldLoginData = () => {\r\n        localStorage.removeItem(globals.localStorageKeys.currentStudent)\r\n        localStorage.removeItem(globals.localStorageKeys.authToken);\r\n        localStorage.removeItem(globals.localStorageKeys.centerId);\r\n        localStorage.removeItem(globals.localStorageKeys.currentUserId);\r\n        localStorage.removeItem(globals.localStorageKeys.roleId);\r\n        setOldDataIsRemoved(true)\r\n    }\r\n\r\n    async function register(centerName, login, password, website, addresses, phone, cityId){\r\n        const salt = bcrypt.genSaltSync(10);\r\n        password = bcrypt.hashSync(password, salt);\r\n\r\n        let data = {\r\n            title: centerName,\r\n            login: login,\r\n            password: password,\r\n            website_url: website,\r\n            addresses: addresses,\r\n            phones: phone,\r\n            city_id: cityId,\r\n        }\r\n\r\n        const result = await axios.post(globals.productionServerDomain + '/courses/register', data);\r\n\r\n        if(result.status !== 200){\r\n            await router.push(\"https://www.oilan.io/\")\r\n        }else{\r\n            console.log(\"errorritto\");\r\n        }\r\n    }\r\n\r\n    const ym = () => {\r\n        return (\r\n            \"<!-- Yandex.Metrika counter -->\\n\" +\r\n            \"<script type=\\\"text/javascript\\\" >\\n\" +\r\n            \"   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};\\n\" +\r\n            \"   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})\\n\" +\r\n            \"   (window, document, \\\"script\\\", \\\"https://mc.yandex.ru/metrika/tag.js\\\", \\\"ym\\\");\\n\" +\r\n            \"\\n\" +\r\n            \"   ym(78186067, \\\"init\\\", {\\n\" +\r\n            \"        clickmap:true,\\n\" +\r\n            \"        trackLinks:true,\\n\" +\r\n            \"        accurateTrackBounce:true,\\n\" +\r\n            \"        webvisor:true,\\n\" +\r\n            \"        ecommerce:\\\"dataLayer\\\"\\n\" +\r\n            \"   });\\n\" +\r\n            \"</script>\\n\" +\r\n            \"<noscript><div><img src=\\\"https://mc.yandex.ru/watch/78186067\\\" style=\\\"position:absolute; left:-9999px;\\\" alt=\\\"\\\" /></div></noscript>\\n\" +\r\n            \"<!-- /Yandex.Metrika counter -->\"\r\n        );\r\n    }\r\n\r\n    useEffect(()=>{\r\n        setOldDataIsRemoved(false)\r\n        removeOldLoginData();\r\n    }, [])\r\n\r\n    return(\r\n        <div>\r\n            <Head>\r\n                <title>Oilan - Вход</title>\r\n                <link rel=\"icon\" href=\"/atom-icon.png\" />\r\n                <div dangerouslySetInnerHTML={{__html: ym()}}/>\r\n            </Head>\r\n\r\n            {oldLoginDataIsRemoved && <Header white={true}/>}\r\n            <ModalWindow show={show} handleClose={handleClose} heading={``} body={<BecomeAPartner handleClose={handleClose}/>}/>\r\n            {/*<ContactButton/>*/}\r\n            <div className={styles.modal} style={{display: showModal ? 'block' : 'none'}}>\r\n                <div style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between'}}>\r\n                    <span style={{fontSize: '14px', fontWeight: 'bold'}}>Служба заботы о пользователях</span>\r\n                    <span style={{fontSize: '14px', fontWeight: 'bold', cursor: 'pointer'}}\r\n                          onClick={()=>{\r\n                              setShowModal(!showModal)\r\n                          }}\r\n                    >x</span>\r\n                </div>\r\n\r\n                <span style={{fontSize: '12px'}}>8:00-20:00 рабочие дни</span> <br/>\r\n                <span style={{fontSize: '12px'}}>9:00-17:00 праздничные и выходные дни</span> <br/> <br/>\r\n                <span style={{fontSize: '14px', fontWeight: 'bold'}}>Телефоны:</span> <br/>\r\n                <span style={{fontSize: '12px'}}>+7 (747) 095 3440 (WhatsApp, Звонок)</span> <br/>\r\n            </div>\r\n            <div className={styles.signInBody}>\r\n                {/*<img src=\"/motivation.png\" className={styles.bgPic} alt=\"\"/>*/}\r\n                {/*<img src=\"/soon.png\" className={styles.bgPic2} alt=\"\"/>*/}\r\n                    <div className={classnames(styles.formBody)}>\r\n                        <div className={styles.header}>\r\n                            <div className={classnames(styles.headerItem, styles.headerItemLeft, !interfaceForStudent && styles.selected)} onClick={()=>{\r\n                                setInterfaceForStudent(false)\r\n                                setLoginValue('')\r\n                            }}>\r\n                                <span>Я центр/репетитор</span>\r\n                            </div>\r\n                            <div className={classnames(styles.headerItem, styles.headerItemRight, interfaceForStudent && styles.selected)} onClick={()=>{\r\n                                setInterfaceForStudent(true)\r\n                            }}>\r\n                                <span>Я студент</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className={styles.form}>\r\n                            <span className={styles.title}>Рады, что вы вернулись</span>\r\n                            <p className={error ? styles.errorMessage : styles.message}>{messageText}</p>\r\n\r\n                            {interfaceForStudent ? (\r\n                                <>\r\n                                    <div className={styles.inputBody}>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            className={styles.input}\r\n                                            onKeyDown={e => {\r\n                                                if(e.keyCode === 8){\r\n                                                    setStudentPhone(studentPhone.slice(0,-1));\r\n                                                }\r\n                                            }}\r\n                                            onChange={e => globals.checkPhoneMask(e.target.value, setStudentPhone)}\r\n                                            placeholder='Номер телефона'\r\n                                            value={studentPhone}\r\n                                        />\r\n                                    </div>\r\n                                    <label style={{fontFamily: 'Rubik Medium', color: 'black', marginTop: '10px', cursor: 'pointer', width: '100%', display: 'flex', justifyContent: 'center', alignItems: 'center'}}>\r\n                                        <input\r\n                                            type=\"checkbox\"\r\n                                            onClick={() => {\r\n                                                setOfertaCheck(!ofertaCheck)\r\n                                            }}\r\n                                        /> <span style={{marginLeft: 10}}>Я принимаю условия <a href=\"/offer/student\" style={{color: 'black', textDecoration: 'underline'}}>публичной оферты.</a></span>\r\n                                    </label>\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <div className={styles.inputBody}>\r\n                                        <input type=\"text\" className={styles.input} value={loginValue} onChange={e => setLoginValue(e.target.value)} placeholder='Логин' id='loginLogin'/>\r\n                                    </div>\r\n\r\n                                    <div className={styles.inputBody} style={{position: 'relative'}}>\r\n                                        <input type={showPassword ? 'text' : \"password\"} onChange={e => setPasswordValue(e.target.value)} className={styles.input} placeholder='Пароль' id='loginPassword'/>\r\n                                        {passwordValue.length!=0 && <img src={!showPassword ? \"/view_eye.png\" : '/hidden.png'} alt=\"\"\r\n                                              className={styles.eye}\r\n                                              onClick={() => {\r\n                                                  setShowPassword(!showPassword)\r\n                                              }}\r\n                                        />}\r\n                                    </div>\r\n                                </>\r\n                            )}\r\n\r\n                            <div className={styles.inputBody} style={{marginTop: '15px'}}>\r\n                                <button\r\n                                    className={styles.submitBtn}\r\n                                    onClick={ () => {\r\n                                        setError(false);\r\n                                        setMessageText('Загрузка...');\r\n                                        if(interfaceForStudent){\r\n                                            if(studentPhone.length!==16){\r\n                                                setMessageText('Неккоректная длина номера!')\r\n                                            } else if (!ofertaCheck) {\r\n                                                setMessageText('Потдвердите соглашение с публичной офертой!')\r\n                                            } else {\r\n                                                axios.post(`${globals.productionServerDomain}/studentLogin/`, {phone: studentPhone}).then(function(res){\r\n                                                    localStorage.setItem(globals.localStorageKeys.currentStudent, JSON.stringify(res.data));\r\n                                                    router.push(`/cabinet/student`)\r\n                                                    return\r\n                                                }).catch(function(){\r\n                                                    setMessageText('Номер телефона не найден!')\r\n                                                })\r\n                                            }\r\n                                        }else{\r\n                                            let data = {\r\n                                                login: loginValue,\r\n                                                password: passwordValue,\r\n                                            }\r\n\r\n                                            axios.post(`${globals.productionServerDomain}/login/`, data).then(function(res){\r\n                                                if(res.status === 200){\r\n                                                    let date = new Date();\r\n                                                    let loginObject = {\r\n                                                        expireTime: date + (60 * 1000 * 60),\r\n                                                        token: res.data.token\r\n                                                    }\r\n\r\n                                                    localStorage.setItem(globals.localStorageKeys.authToken, JSON.stringify(loginObject));\r\n                                                    localStorage.setItem(globals.localStorageKeys.centerId, res.data.centerId);\r\n                                                    localStorage.setItem(globals.localStorageKeys.currentUserId, res.data.userId);\r\n                                                    localStorage.setItem(globals.localStorageKeys.roleId, res.data.roleId);\r\n\r\n                                                    console.log('center id set', res.data.centerId);\r\n\r\n                                                    if(res.data.roleId === 1){\r\n                                                        router.push(`${globals.productionSiteDomain}/admin`)\r\n                                                    }\r\n                                                    else if(res.data.roleId === 4){\r\n                                                        router.push(`${globals.productionSiteDomain}/cabinet`)\r\n                                                    }\r\n                                                    else if(res.data.roleId === 6){\r\n                                                        router.push(`${globals.productionSiteDomain}/cabinet/tutor`)\r\n                                                    }\r\n                                                }else{\r\n                                                    setError(true);\r\n                                                    setMessageText(\"Неправильные данные\")\r\n                                                }\r\n                                            }).catch((res) => {\r\n                                                setError(true);\r\n                                                setMessageText(\"Неправильные данные! Попробуйте еще раз.\")\r\n                                            });\r\n                                        }\r\n\r\n\r\n                                    }}\r\n                                    >\r\n                                    Войти в личный кабинет\r\n                                </button>\r\n                            </div>\r\n\r\n                            <br/>\r\n                            {!interfaceForStudent && (\r\n                                <div className={styles.inputBody}>\r\n                                    <span\r\n                                        style={{\r\n                                            color: 'black',\r\n                                            cursor: 'pointer',\r\n                                            fontSize: '14px',\r\n                                            textDecoration: 'underline',\r\n                                            fontFamily: 'Rubik Regular'\r\n                                        }}\r\n                                        onClick={()=>{\r\n                                            setShow(!show)\r\n                                        }}\r\n                                    >Стать партнером</span>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            <Footer/>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SignIn;\r\n"]},"metadata":{},"sourceType":"module"}